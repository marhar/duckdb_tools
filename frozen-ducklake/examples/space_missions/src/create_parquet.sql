-- "Create a small space exploration database suitable for teaching SQL concepts.
--  It should have at least three tables, and each table should have between 25
--  and 300 rows of sample data.  The intent is to split some of the tables into
--  multiple data files, so the data should be large enough to make that meaningful.
--  Then create SQL queries that demonstrate useful queries against this data, with
--  enough complexity so that joins, aggregations, etc, are necessary."

CREATE TABLE astronauts (
    astronaut_id INTEGER PRIMARY KEY,
    name VARCHAR,
    nationality VARCHAR,
    birth_date DATE,
    agency VARCHAR,
    first_flight DATE,
    total_flights INTEGER,
    total_eva_hours DECIMAL(5,2),
    total_space_days DECIMAL(7,2),
    status VARCHAR
);

INSERT INTO astronauts VALUES
(1, 'Neil Armstrong', 'USA', '1930-08-05', 'NASA', '1966-03-16', 2, 2.50, 8.58, 'Retired'),
(2, 'Buzz Aldrin', 'USA', '1930-01-20', 'NASA', '1966-11-11', 2, 5.50, 12.25, 'Retired'),
(3, 'Yuri Gagarin', 'Russia', '1934-03-09', 'Soviet Union', '1961-04-12', 1, 0.00, 0.07, 'Deceased'),
(4, 'John Glenn', 'USA', '1921-07-18', 'NASA', '1962-02-20', 2, 0.00, 8.75, 'Deceased'),
(5, 'Sally Ride', 'USA', '1951-05-26', 'NASA', '1983-06-18', 2, 0.00, 14.25, 'Deceased'),
(6, 'Valentina Tereshkova', 'Russia', '1937-03-06', 'Soviet Union', '1963-06-16', 1, 0.00, 2.95, 'Retired'),
(7, 'Chris Hadfield', 'Canada', '1959-08-29', 'CSA', '1995-11-12', 3, 14.85, 166.00, 'Retired'),
(8, 'Scott Kelly', 'USA', '1964-02-21', 'NASA', '1999-12-19', 4, 18.02, 520.00, 'Retired'),
(9, 'Peggy Whitson', 'USA', '1960-02-09', 'NASA', '2002-06-05', 3, 60.21, 665.00, 'Retired'),
(10, 'Sergey Krikalev', 'Russia', '1958-08-27', 'Roscosmos', '1988-11-26', 6, 41.68, 803.00, 'Retired'),
(11, 'Gennady Padalka', 'Russia', '1958-06-21', 'Roscosmos', '1998-08-13', 5, 38.44, 878.00, 'Retired'),
(12, 'Yang Liwei', 'China', '1965-06-21', 'CNSA', '2003-10-15', 1, 0.00, 0.95, 'Active'),
(13, 'Tim Peake', 'UK', '1972-04-07', 'ESA', '2015-12-15', 1, 4.43, 186.00, 'Active'),
(14, 'Samantha Cristoforetti', 'Italy', '1977-04-26', 'ESA', '2014-11-23', 2, 15.28, 369.00, 'Active'),
(15, 'Jessica Meir', 'USA', '1977-07-01', 'NASA', '2019-09-25', 1, 18.15, 205.00, 'Active'),
(16, 'Christina Koch', 'USA', '1979-02-28', 'NASA', '2019-03-14', 1, 42.15, 328.00, 'Active'),
(17, 'Doug Hurley', 'USA', '1966-10-21', 'NASA', '2009-07-15', 2, 18.95, 84.00, 'Active'),
(18, 'Bob Behnken', 'USA', '1970-07-28', 'NASA', '2008-03-11', 2, 37.05, 110.00, 'Active'),
(19, 'Akihiko Hoshide', 'Japan', '1968-12-28', 'JAXA', '2008-05-31', 3, 28.17, 340.00, 'Active'),
(20, 'Thomas Pesquet', 'France', '1978-02-27', 'ESA', '2016-11-17', 2, 12.58, 396.00, 'Active'),
(21, 'Mark Watney', 'USA', '1975-10-12', 'NASA', '2020-02-29', 1, 0.00, 549.00, 'Active'),
(22, 'Kayla Barron', 'USA', '1987-09-19', 'NASA', '2021-10-14', 1, 0.00, 176.00, 'Active'),
(23, 'Matthias Maurer', 'Germany', '1970-03-18', 'ESA', '2021-11-10', 1, 7.75, 177.00, 'Active'),
(24, 'Wang Yaping', 'China', '1980-01-27', 'CNSA', '2013-06-11', 2, 7.45, 198.00, 'Active'),
(25, 'Zhai Zhigang', 'China', '1966-10-10', 'CNSA', '2008-09-25', 2, 4.12, 198.00, 'Active'),
(26, 'Sunita Williams', 'USA', '1965-09-19', 'NASA', '2006-12-09', 2, 50.40, 322.00, 'Active'),
(27, 'Frank Rubio', 'USA', '1975-12-11', 'NASA', '2022-09-21', 1, 14.13, 371.00, 'Active'),
(28, 'Sergey Prokopyev', 'Russia', '1975-02-20', 'Roscosmos', '2018-06-06', 2, 19.75, 567.00, 'Active'),
(29, 'Oleg Artemyev', 'Russia', '1970-12-28', 'Roscosmos', '2014-03-25', 3, 20.17, 561.00, 'Active'),
(30, 'Denis Matveev', 'Russia', '1983-02-05', 'Roscosmos', '2022-03-18', 1, 18.37, 195.00, 'Active'),
(31, 'Konstantin Borisov', 'Russia', '1982-05-05', 'Roscosmos', '2023-09-15', 1, 0.00, 204.00, 'Active'),
(32, 'Nikolai Chub', 'Russia', '1982-05-05', 'Roscosmos', '2023-09-15', 1, 7.17, 374.00, 'Active'),
(33, 'Loral O''Hara', 'USA', '1983-05-03', 'NASA', '2023-09-15', 1, 0.00, 204.00, 'Active'),
(34, 'Jasmin Moghbeli', 'USA', '1983-06-24', 'NASA', '2023-08-26', 1, 13.83, 199.00, 'Active'),
(35, 'Andreas Mogensen', 'Denmark', '1976-11-02', 'ESA', '2015-09-02', 2, 13.92, 209.00, 'Active'),
(36, 'Satoshi Furukawa', 'Japan', '1964-04-04', 'JAXA', '2011-06-07', 2, 0.00, 365.00, 'Active'),
(37, 'Michael López-Alegría', 'USA', '1958-05-30', 'Axiom Space', '1995-10-20', 4, 67.40, 257.00, 'Active'),
(38, 'Jared Isaacman', 'USA', '1983-02-11', 'SpaceX', '2021-09-15', 2, 2.12, 8.00, 'Active'),
(39, 'Hayley Arceneaux', 'USA', '1991-12-04', 'SpaceX', '2021-09-15', 1, 0.00, 3.00, 'Active'),
(40, 'Sian Proctor', 'USA', '1970-03-28', 'SpaceX', '2021-09-15', 1, 0.00, 3.00, 'Active'),
(41, 'Chris Sembroski', 'USA', '1979-08-28', 'SpaceX', '2021-09-15', 1, 0.00, 3.00, 'Active'),
(42, 'William Shatner', 'Canada', '1931-03-22', 'Blue Origin', '2021-10-13', 1, 0.00, 0.01, 'Active'),
(43, 'Jeff Bezos', 'USA', '1964-01-12', 'Blue Origin', '2021-07-20', 1, 0.00, 0.01, 'Active'),
(44, 'Richard Branson', 'UK', '1950-07-18', 'Virgin Galactic', '2021-07-11', 1, 0.00, 0.01, 'Active'),
(45, 'Mae Jemison', 'USA', '1956-10-17', 'NASA', '1992-09-12', 1, 0.00, 8.00, 'Retired'),
(46, 'Kalpana Chawla', 'India', '1962-03-17', 'NASA', '1997-11-19', 2, 0.00, 30.58, 'Deceased'),
(47, 'Ilan Ramon', 'Israel', '1954-06-20', 'NASA', '2003-01-16', 1, 0.00, 15.92, 'Deceased'),
(48, 'Rick Husband', 'USA', '1957-07-12', 'NASA', '1999-05-27', 2, 0.00, 31.75, 'Deceased'),
(49, 'Kalpana Chawla', 'India', '1962-03-17', 'NASA', '1997-11-19', 2, 0.00, 30.58, 'Deceased'),
(50, 'Liu Yang', 'China', '1978-10-06', 'CNSA', '2012-06-16', 2, 0.00, 26.00, 'Active'),
(51, 'Nie Haisheng', 'China', '1964-10-13', 'CNSA', '2005-10-12', 3, 0.00, 107.00, 'Active'),
(52, 'Jing Haipeng', 'China', '1966-10-24', 'CNSA', '2008-09-25', 3, 0.00, 49.00, 'Active'),
(53, 'Ye Guangfu', 'China', '1980-09-08', 'CNSA', '2021-10-16', 1, 12.17, 183.00, 'Active'),
(54, 'Tang Hongbo', 'China', '1975-10-23', 'CNSA', '2021-06-17', 2, 7.67, 275.00, 'Active'),
(55, 'Chen Dong', 'China', '1978-12-12', 'CNSA', '2016-10-17', 2, 0.00, 213.00, 'Active'),
(56, 'Cai Xuzhe', 'China', '1976-05-05', 'CNSA', '2021-10-16', 2, 7.33, 366.00, 'Active'),
(57, 'Liu Boming', 'China', '1966-09-17', 'CNSA', '2008-09-25', 2, 7.17, 276.00, 'Active'),
(58, 'Deke Slayton', 'USA', '1924-03-01', 'NASA', '1975-07-15', 1, 0.00, 9.02, 'Deceased'),
(59, 'Alan Shepard', 'USA', '1923-11-18', 'NASA', '1961-05-05', 2, 9.38, 9.05, 'Deceased'),
(60, 'Wally Schirra', 'USA', '1923-03-12', 'NASA', '1962-10-03', 3, 0.00, 12.35, 'Deceased'),
(61, 'Gordon Cooper', 'USA', '1927-03-06', 'NASA', '1963-05-15', 2, 0.00, 9.58, 'Deceased'),
(62, 'Jim Lovell', 'USA', '1928-03-25', 'NASA', '1965-12-04', 4, 0.00, 29.92, 'Retired'),
(63, 'Frank Borman', 'USA', '1928-03-14', 'NASA', '1965-12-04', 2, 0.00, 19.92, 'Deceased'),
(64, 'William Anders', 'USA', '1933-10-17', 'NASA', '1968-12-21', 1, 0.00, 6.08, 'Deceased'),
(65, 'Michael Collins', 'USA', '1930-10-31', 'NASA', '1966-07-18', 2, 1.27, 11.08, 'Deceased'),
(66, 'Pete Conrad', 'USA', '1930-06-02', 'NASA', '1965-08-21', 4, 7.75, 49.33, 'Deceased'),
(67, 'Alan Bean', 'USA', '1932-03-15', 'NASA', '1969-11-14', 2, 10.26, 69.15, 'Deceased'),
(68, 'David Scott', 'USA', '1932-06-06', 'NASA', '1966-03-16', 3, 20.93, 22.75, 'Retired'),
(69, 'James Irwin', 'USA', '1930-03-17', 'NASA', '1971-07-26', 1, 18.35, 12.31, 'Deceased'),
(70, 'John Young', 'USA', '1930-09-24', 'NASA', '1965-03-23', 6, 20.14, 34.75, 'Deceased'),
(71, 'Gene Cernan', 'USA', '1934-03-14', 'NASA', '1966-06-03', 3, 24.00, 23.25, 'Deceased'),
(72, 'Harrison Schmitt', 'USA', '1935-07-03', 'NASA', '1972-12-07', 1, 22.05, 12.58, 'Retired'),
(73, 'Mae Jemison', 'USA', '1956-10-17', 'NASA', '1992-09-12', 1, 0.00, 8.00, 'Retired'),
(74, 'Eileen Collins', 'USA', '1956-11-19', 'NASA', '1995-02-03', 4, 0.00, 38.75, 'Retired'),
(75, 'Kathryn Sullivan', 'USA', '1951-10-03', 'NASA', '1984-10-05', 3, 3.25, 22.00, 'Retired'),
(76, 'Roberta Seddon', 'USA', '1947-11-12', 'NASA', '1985-04-12', 1, 0.00, 7.00, 'Retired'),
(77, 'Ulf Merbold', 'Germany', '1941-06-20', 'ESA', '1983-11-28', 3, 0.00, 25.42, 'Retired'),
(78, 'Claude Nicollier', 'Switzerland', '1944-09-02', 'ESA', '1992-07-31', 4, 8.18, 42.75, 'Retired'),
(79, 'Roberto Vittori', 'Italy', '1964-10-15', 'ESA', '2005-04-15', 3, 0.00, 35.00, 'Active'),
(80, 'Paolo Nespoli', 'Italy', '1957-04-06', 'ESA', '2007-10-23', 3, 0.00, 313.00, 'Retired'),
(81, 'Luca Parmitano', 'Italy', '1976-09-23', 'ESA', '2013-05-28', 2, 33.09, 367.00, 'Active'),
(82, 'Alexander Gerst', 'Germany', '1976-05-03', 'ESA', '2014-05-28', 2, 12.32, 362.00, 'Active'),
(83, 'Koichi Wakata', 'Japan', '1963-08-01', 'JAXA', '1996-01-11', 5, 0.00, 347.00, 'Active'),
(84, 'Soichi Noguchi', 'Japan', '1965-04-15', 'JAXA', '2005-07-26', 3, 0.00, 344.00, 'Active'),
(85, 'Takuya Onishi', 'Japan', '1975-12-22', 'JAXA', '2016-07-07', 1, 0.00, 115.00, 'Active');

CREATE TABLE spacecraft (
    spacecraft_id INTEGER PRIMARY KEY,
    name VARCHAR,
    manufacturer VARCHAR,
    first_flight DATE,
    crew_capacity INTEGER,
    mission_type VARCHAR,
    status VARCHAR
);

INSERT INTO spacecraft VALUES
(1, 'Apollo Command Module', 'North American Aviation', '1968-10-11', 3, 'Lunar', 'Retired'),
(2, 'Space Shuttle Atlantis', 'Rockwell International', '1985-10-03', 8, 'LEO', 'Retired'),
(3, 'Soyuz MS', 'Roscosmos', '2016-07-07', 3, 'ISS Transport', 'Active'),
(4, 'Dragon 2', 'SpaceX', '2020-05-30', 7, 'ISS Transport', 'Active'),
(5, 'Orion', 'Lockheed Martin', '2022-11-16', 6, 'Deep Space', 'Active'),
(6, 'Space Shuttle Discovery', 'Rockwell International', '1984-08-30', 8, 'LEO', 'Retired'),
(7, 'Apollo Lunar Module', 'Grumman', '1969-03-03', 2, 'Lunar Landing', 'Retired'),
(8, 'Gemini', 'McDonnell Aircraft', '1965-03-23', 2, 'LEO', 'Retired'),
(9, 'Mercury', 'McDonnell Aircraft', '1961-05-05', 1, 'Suborbital', 'Retired'),
(10, 'Space Shuttle Endeavour', 'Rockwell International', '1992-05-07', 8, 'LEO', 'Retired'),
(11, 'Space Shuttle Columbia', 'Rockwell International', '1981-04-12', 8, 'LEO', 'Retired'),
(12, 'Space Shuttle Challenger', 'Rockwell International', '1983-04-04', 8, 'LEO', 'Retired'),
(13, 'Vostok', 'OKB-1', '1961-04-12', 1, 'LEO', 'Retired'),
(14, 'Shenzhou', 'CAST', '2003-10-15', 3, 'LEO', 'Active'),
(15, 'CST-100 Starliner', 'Boeing', '2022-05-19', 7, 'ISS Transport', 'Active'),
(16, 'New Shepard', 'Blue Origin', '2021-07-20', 6, 'Suborbital', 'Active'),
(17, 'Virgin Galactic SpaceShipTwo', 'Virgin Galactic', '2021-07-11', 6, 'Suborbital', 'Active'),
(18, 'Progress', 'Roscosmos', '1978-01-20', 0, 'Cargo', 'Active'),
(19, 'Cargo Dragon', 'SpaceX', '2012-10-07', 0, 'Cargo', 'Active'),
(20, 'Cygnus', 'Northrop Grumman', '2013-09-18', 0, 'Cargo', 'Active'),
(21, 'HTV', 'JAXA', '2009-09-10', 0, 'Cargo', 'Retired'),
(22, 'ATV', 'ESA', '2008-03-09', 0, 'Cargo', 'Retired'),
(23, 'Tianzhou', 'CNSA', '2017-04-20', 0, 'Cargo', 'Active'),
(24, 'Apollo Service Module', 'North American Aviation', '1968-10-11', 0, 'Lunar Support', 'Retired'),
(25, 'Lunar Gateway', 'Multiple', '2026-11-01', 4, 'Lunar Orbit', 'Development'),
(26, 'Starship', 'SpaceX', '2024-06-06', 100, 'Deep Space', 'Testing'),
(27, 'Dream Chaser', 'Sierra Nevada Corp', '2023-12-09', 7, 'ISS Transport', 'Active'),
(28, 'Gaganyaan', 'ISRO', '2024-12-01', 3, 'LEO', 'Testing'),
(29, 'Orel', 'Roscosmos', '2025-01-15', 4, 'Deep Space', 'Development'),
(30, 'XPEV', 'CNSA', '2025-03-01', 2, 'LEO', 'Development'),
(31, 'SpaceX Raptor', 'SpaceX', '2023-04-20', 0, 'Propulsion', 'Active'),
(32, 'Blue Moon', 'Blue Origin', '2026-12-01', 0, 'Lunar Landing', 'Development');

CREATE TABLE missions (
    mission_id INTEGER PRIMARY KEY,
    name VARCHAR,
    launch_date DATE,
    end_date DATE,
    spacecraft_id INTEGER,
    agency VARCHAR,
    mission_type VARCHAR,
    success_status VARCHAR,
    cost_millions_usd DECIMAL(8,2),
    duration_days INTEGER,
    FOREIGN KEY (spacecraft_id) REFERENCES spacecraft(spacecraft_id)
);

INSERT INTO missions VALUES
(1, 'Apollo 11', '1969-07-16', '1969-07-24', 1, 'NASA', 'Lunar Landing', 'Success', 25400.00, 8),
(2, 'Apollo 12', '1969-11-14', '1969-11-24', 1, 'NASA', 'Lunar Landing', 'Success', 25400.00, 10),
(3, 'STS-1', '1981-04-12', '1981-04-14', 11, 'NASA', 'Test Flight', 'Success', 196.00, 2),
(4, 'STS-135', '2011-07-08', '2011-07-21', 2, 'NASA', 'ISS Resupply', 'Success', 450.00, 13),
(5, 'Expedition 1', '2000-10-31', '2001-03-21', 3, 'NASA/Roscosmos', 'ISS Operations', 'Success', 150.00, 141),
(6, 'Demo-2', '2020-05-30', '2020-08-02', 4, 'NASA/SpaceX', 'Crew Test', 'Success', 55.00, 64),
(7, 'Artemis 1', '2022-11-16', '2022-12-11', 5, 'NASA', 'Lunar Test', 'Success', 4100.00, 25),
(8, 'Vostok 1', '1961-04-12', '1961-04-12', 13, 'Soviet Union', 'First Human Flight', 'Success', 7.00, 0),
(9, 'Mercury-Redstone 3', '1961-05-05', '1961-05-05', 9, 'NASA', 'Suborbital Test', 'Success', 7.00, 0),
(10, 'Gemini 4', '1965-06-03', '1965-06-07', 8, 'NASA', 'EVA Test', 'Success', 1280.00, 4),
(11, 'Apollo 13', '1970-04-11', '1970-04-17', 1, 'NASA', 'Lunar Landing', 'Partial Failure', 25400.00, 6),
(12, 'STS-51-L', '1986-01-28', '1986-01-28', 12, 'NASA', 'Satellite Deploy', 'Failure', 175.00, 0),
(13, 'Shenzhou 5', '2003-10-15', '2003-10-16', 14, 'CNSA', 'First Chinese Crewed', 'Success', 110.00, 1),
(14, 'SpaceX Crew-1', '2020-11-15', '2021-05-02', 4, 'NASA/SpaceX', 'ISS Crew Rotation', 'Success', 55.00, 168),
(15, 'Blue Origin NS-16', '2021-07-20', '2021-07-20', 16, 'Blue Origin', 'Space Tourism', 'Success', 5.50, 0),
(16, 'Virgin Galactic Unity 22', '2021-07-11', '2021-07-11', 17, 'Virgin Galactic', 'Space Tourism', 'Success', 4.50, 0),
(17, 'Apollo 8', '1968-12-21', '1968-12-25', 1, 'NASA', 'Lunar Orbit', 'Success', 25400.00, 4),
(18, 'Apollo 17', '1972-12-07', '1972-12-19', 1, 'NASA', 'Lunar Landing', 'Success', 25400.00, 12),
(19, 'STS-41-G', '1984-10-05', '1984-10-13', 12, 'NASA', 'Satellite Deploy', 'Success', 209.00, 8),
(20, 'Expedition 65', '2021-04-09', '2021-10-17', 3, 'NASA/Roscosmos', 'ISS Operations', 'Success', 150.00, 191),
(21, 'SpaceX Crew-5', '2022-10-05', '2023-03-11', 4, 'NASA/SpaceX', 'ISS Crew Rotation', 'Success', 55.00, 157),
(22, 'Soyuz MS-22', '2022-09-21', '2023-03-28', 3, 'Roscosmos', 'ISS Transport', 'Partial Failure', 48.00, 188),
(23, 'Starliner OFT-2', '2022-05-19', '2022-05-25', 15, 'NASA/Boeing', 'Uncrewed Test', 'Success', 90.00, 6),
(24, 'Chang''e 4', '2018-12-07', '2020-09-17', 30, 'CNSA', 'Lunar Landing', 'Success', 180.00, 649),
(25, 'Parker Solar Probe', '2018-08-12', '2025-12-24', 26, 'NASA', 'Solar Research', 'Success', 1500.00, 2691),
(26, 'James Webb Space Telescope', '2021-12-25', '2031-12-25', 26, 'NASA/ESA', 'Deep Space Observatory', 'Success', 10000.00, 3653),
(27, 'Perseverance Mars Landing', '2020-07-30', '2024-12-31', 26, 'NASA', 'Mars Exploration', 'Success', 2700.00, 1614),
(28, 'Europa Clipper', '2024-10-14', '2030-04-11', 26, 'NASA', 'Jupiter Moon Study', 'Active', 5200.00, 2005),
(29, 'Artemis 2', '2025-11-01', '2025-11-11', 5, 'NASA', 'Lunar Flyby', 'Planned', 4100.00, 10),
(30, 'SpaceX Dear Moon', '2025-12-01', '2025-12-08', 26, 'SpaceX', 'Lunar Tourism', 'Planned', 100.00, 7),
(31, 'Polaris Dawn', '2024-08-27', '2024-08-31', 4, 'SpaceX', 'Private EVA', 'Success', 200.00, 4),
(32, 'Inspiration4', '2021-09-15', '2021-09-18', 4, 'SpaceX', 'Space Tourism', 'Success', 200.00, 3),
(33, 'Axiom-1', '2022-04-08', '2022-04-25', 4, 'Axiom Space', 'Private ISS', 'Success', 55.00, 17),
(34, 'Tianwen-1', '2020-07-23', '2022-12-31', 14, 'CNSA', 'Mars Exploration', 'Success', 450.00, 892),
(35, 'Chandrayaan-3', '2023-07-14', '2024-08-23', 28, 'ISRO', 'Lunar Landing', 'Success', 75.00, 405),
(36, 'DART Mission', '2021-11-24', '2022-09-26', 26, 'NASA', 'Asteroid Impact', 'Success', 325.00, 306),
(37, 'Lucy Mission', '2021-10-16', '2033-04-01', 26, 'NASA', 'Asteroid Study', 'Active', 981.00, 4184),
(38, 'OSIRIS-REx', '2016-09-08', '2023-09-24', 26, 'NASA', 'Asteroid Sample', 'Success', 1160.00, 2573),
(39, 'Juno', '2011-08-05', '2025-07-30', 26, 'NASA', 'Jupiter Study', 'Active', 1130.00, 5108),
(40, 'Cassini-Huygens', '1997-10-15', '2017-09-15', 26, 'NASA/ESA', 'Saturn Study', 'Success', 3900.00, 7305),
(41, 'New Horizons', '2006-01-19', '2026-01-01', 26, 'NASA', 'Pluto Flyby', 'Success', 720.00, 7317),
(42, 'Voyager 1', '1977-09-05', '2025-12-31', 26, 'NASA', 'Outer Planet Study', 'Active', 865.00, 17648),
(43, 'Voyager 2', '1977-08-20', '2025-12-31', 26, 'NASA', 'Outer Planet Study', 'Active', 865.00, 17664),
(44, 'Hubble Space Telescope', '1990-04-24', '2030-06-01', 26, 'NASA/ESA', 'Space Observatory', 'Active', 16000.00, 14647),
(45, 'International Space Station', '1998-11-20', '2031-01-01', 26, 'International', 'Space Laboratory', 'Active', 150000.00, 11759),
(46, 'SpaceX Crew-7', '2023-08-26', '2024-03-12', 4, 'NASA/SpaceX', 'ISS Crew Rotation', 'Success', 55.00, 199),
(47, 'SpaceX Crew-8', '2024-03-03', '2024-10-25', 4, 'NASA/SpaceX', 'ISS Crew Rotation', 'Success', 55.00, 236),
(48, 'Soyuz MS-25', '2024-03-23', '2024-09-23', 3, 'Roscosmos', 'ISS Transport', 'Success', 48.00, 184),
(49, 'BepiColombo', '2018-10-20', '2025-12-01', 26, 'ESA/JAXA', 'Mercury Study', 'Active', 2000.00, 2598),
(50, 'Solar Orbiter', '2020-02-10', '2027-12-31', 26, 'ESA/NASA', 'Solar Study', 'Active', 1500.00, 2881),
(51, 'STS-61', '1993-12-02', '1993-12-13', 6, 'NASA', 'Hubble Repair', 'Success', 750.00, 11),
(52, 'STS-82', '1997-02-11', '1997-02-21', 6, 'NASA', 'Hubble Repair', 'Success', 750.00, 10),
(53, 'STS-103', '1999-12-19', '1999-12-27', 6, 'NASA', 'Hubble Repair', 'Success', 750.00, 8),
(54, 'STS-109', '2002-03-01', '2002-03-12', 11, 'NASA', 'Hubble Repair', 'Success', 750.00, 11),
(55, 'STS-125', '2009-05-11', '2009-05-24', 2, 'NASA', 'Hubble Repair', 'Success', 750.00, 13),
(56, 'Shenzhou 12', '2021-06-17', '2021-09-17', 14, 'CNSA', 'Space Station Crew', 'Success', 110.00, 92),
(57, 'Shenzhou 13', '2021-10-16', '2022-04-16', 14, 'CNSA', 'Space Station Crew', 'Success', 110.00, 183),
(58, 'Shenzhou 14', '2022-06-05', '2022-12-04', 14, 'CNSA', 'Space Station Crew', 'Success', 110.00, 182),
(59, 'Shenzhou 15', '2022-11-29', '2023-06-04', 14, 'CNSA', 'Space Station Crew', 'Success', 110.00, 187),
(60, 'Shenzhou 16', '2023-05-30', '2023-10-31', 14, 'CNSA', 'Space Station Crew', 'Success', 110.00, 154),
(61, 'Shenzhou 17', '2023-10-26', '2024-04-30', 14, 'CNSA', 'Space Station Crew', 'Success', 110.00, 187),
(62, 'Shenzhou 18', '2024-04-25', '2024-10-30', 14, 'CNSA', 'Space Station Crew', 'Success', 110.00, 188),
(63, 'SpaceX Crew-6', '2023-03-02', '2023-09-04', 4, 'NASA/SpaceX', 'ISS Crew Rotation', 'Success', 55.00, 186),
(64, 'SpaceX Crew-9', '2024-09-28', '2025-02-01', 4, 'NASA/SpaceX', 'ISS Crew Rotation', 'Active', 55.00, 126),
(65, 'Axiom-2', '2023-05-21', '2023-05-30', 4, 'Axiom Space', 'Private ISS', 'Success', 55.00, 9),
(66, 'Axiom-3', '2024-01-18', '2024-02-09', 4, 'Axiom Space', 'Private ISS', 'Success', 55.00, 22),
(67, 'Polaris Dawn', '2024-08-27', '2024-08-31', 4, 'SpaceX', 'Private EVA', 'Success', 200.00, 4),
(68, 'Europa Clipper Launch', '2024-10-14', '2030-04-11', 26, 'NASA', 'Jupiter Moon Study', 'Active', 5200.00, 2005);

CREATE TABLE mission_crew (
    mission_crew_id INTEGER PRIMARY KEY,
    mission_id INTEGER,
    astronaut_id INTEGER,
    role VARCHAR,
    primary_crew BOOLEAN,
    backup_crew BOOLEAN,
    FOREIGN KEY (mission_id) REFERENCES missions(mission_id),
    FOREIGN KEY (astronaut_id) REFERENCES astronauts(astronaut_id)
);

INSERT INTO mission_crew VALUES
(1, 1, 1, 'Commander', TRUE, FALSE),
(2, 1, 2, 'Lunar Module Pilot', TRUE, FALSE),
(3, 1, 65, 'Command Module Pilot', TRUE, FALSE),
(4, 2, 66, 'Commander', TRUE, FALSE),
(5, 2, 67, 'Lunar Module Pilot', TRUE, FALSE),
(6, 3, 62, 'Commander', TRUE, FALSE),
(7, 3, 4, 'Pilot', TRUE, FALSE),
(8, 6, 17, 'Commander', TRUE, FALSE),
(9, 6, 18, 'Pilot', TRUE, FALSE),
(10, 8, 3, 'Pilot', TRUE, FALSE),
(11, 9, 59, 'Pilot', TRUE, FALSE),
(12, 10, 1, 'Commander', TRUE, FALSE),
(13, 11, 62, 'Commander', TRUE, FALSE),
(14, 11, 58, 'Command Module Pilot', TRUE, FALSE),
(15, 12, 48, 'Commander', TRUE, FALSE),
(16, 12, 46, 'Mission Specialist', TRUE, FALSE),
(17, 13, 12, 'Taikonaut', TRUE, FALSE),
(18, 14, 17, 'Commander', TRUE, FALSE),
(19, 14, 18, 'Pilot', TRUE, FALSE),
(20, 14, 19, 'Mission Specialist', TRUE, FALSE),
(21, 15, 43, 'Passenger', TRUE, FALSE),
(22, 16, 44, 'Passenger', TRUE, FALSE),
(23, 17, 62, 'Commander', TRUE, FALSE),
(24, 17, 63, 'Command Module Pilot', TRUE, FALSE),
(25, 17, 64, 'Command Module Pilot', TRUE, FALSE),
(26, 18, 71, 'Commander', TRUE, FALSE),
(27, 18, 72, 'Lunar Module Pilot', TRUE, FALSE),
(28, 19, 5, 'Mission Specialist', TRUE, FALSE),
(29, 19, 74, 'Commander', TRUE, FALSE),
(30, 20, 8, 'Flight Engineer', TRUE, FALSE),
(31, 20, 9, 'Commander', TRUE, FALSE),
(32, 21, 22, 'Mission Specialist', TRUE, FALSE),
(33, 21, 23, 'Mission Specialist', TRUE, FALSE),
(34, 22, 28, 'Commander', TRUE, FALSE),
(35, 22, 27, 'Flight Engineer', TRUE, FALSE),
(36, 23, 15, 'Test Pilot', TRUE, FALSE),
(37, 32, 38, 'Commander', TRUE, FALSE),
(38, 32, 39, 'Medical Officer', TRUE, FALSE),
(39, 32, 40, 'Pilot', TRUE, FALSE),
(40, 32, 41, 'Mission Specialist', TRUE, FALSE),
(41, 33, 37, 'Commander', TRUE, FALSE),
(42, 46, 20, 'Mission Specialist', TRUE, FALSE),
(43, 46, 14, 'Commander', TRUE, FALSE),
(44, 47, 16, 'Flight Engineer', TRUE, FALSE),
(45, 47, 15, 'Commander', TRUE, FALSE),
(46, 48, 29, 'Commander', TRUE, FALSE),
(47, 48, 30, 'Flight Engineer', TRUE, FALSE),
(48, 56, 54, 'Commander', TRUE, FALSE),
(49, 56, 53, 'Flight Engineer', TRUE, FALSE),
(50, 56, 25, 'Flight Engineer', TRUE, FALSE),
(51, 57, 25, 'Commander', TRUE, FALSE),
(52, 57, 24, 'Flight Engineer', TRUE, FALSE),
(53, 57, 53, 'Flight Engineer', TRUE, FALSE),
(54, 58, 55, 'Commander', TRUE, FALSE),
(55, 58, 57, 'Flight Engineer', TRUE, FALSE),
(56, 58, 56, 'Flight Engineer', TRUE, FALSE),
(57, 59, 51, 'Commander', TRUE, FALSE),
(58, 59, 52, 'Flight Engineer', TRUE, FALSE),
(59, 59, 56, 'Flight Engineer', TRUE, FALSE),
(60, 60, 53, 'Commander', TRUE, FALSE),
(61, 60, 54, 'Flight Engineer', TRUE, FALSE),
(62, 60, 50, 'Flight Engineer', TRUE, FALSE),
(63, 61, 56, 'Commander', TRUE, FALSE),
(64, 61, 54, 'Flight Engineer', TRUE, FALSE),
(65, 61, 57, 'Flight Engineer', TRUE, FALSE),
(66, 62, 53, 'Commander', TRUE, FALSE),
(67, 62, 25, 'Flight Engineer', TRUE, FALSE),
(68, 62, 50, 'Flight Engineer', TRUE, FALSE),
(69, 63, 20, 'Commander', TRUE, FALSE),
(70, 63, 35, 'Pilot', TRUE, FALSE),
(71, 63, 14, 'Mission Specialist', TRUE, FALSE),
(72, 63, 19, 'Mission Specialist', TRUE, FALSE),
(73, 64, 16, 'Commander', TRUE, FALSE),
(74, 64, 15, 'Pilot', TRUE, FALSE),
(75, 64, 31, 'Flight Engineer', TRUE, FALSE),
(76, 64, 32, 'Flight Engineer', TRUE, FALSE),
(77, 65, 37, 'Commander', TRUE, FALSE),
(78, 66, 37, 'Commander', TRUE, FALSE),
(79, 67, 38, 'Commander', TRUE, FALSE),
(80, 5, 10, 'Flight Engineer', TRUE, FALSE),
(81, 5, 11, 'Commander', TRUE, FALSE),
(82, 51, 26, 'Mission Specialist', TRUE, FALSE),
(83, 51, 7, 'Mission Specialist', TRUE, FALSE),
(84, 52, 74, 'Commander', TRUE, FALSE),
(85, 52, 8, 'Mission Specialist', TRUE, FALSE),
(86, 53, 5, 'Commander', TRUE, FALSE),
(87, 53, 26, 'Mission Specialist', TRUE, FALSE),
(88, 54, 8, 'Commander', TRUE, FALSE),
(89, 54, 9, 'Mission Specialist', TRUE, FALSE),
(90, 55, 2, 'Mission Specialist', TRUE, FALSE),
(91, 55, 8, 'Commander', TRUE, FALSE),
-- Adding backup crew members for some missions
(92, 1, 62, 'Backup Commander', FALSE, TRUE),
(93, 1, 66, 'Backup Lunar Module Pilot', FALSE, TRUE),
(94, 1, 75, 'Backup Command Module Pilot', FALSE, TRUE),
(95, 2, 70, 'Backup Commander', FALSE, TRUE),
(96, 2, 69, 'Backup Lunar Module Pilot', FALSE, TRUE),
(97, 8, 58, 'Backup Pilot', FALSE, TRUE),
(98, 11, 70, 'Backup Commander', FALSE, TRUE),
(99, 11, 71, 'Backup Lunar Module Pilot', FALSE, TRUE),
(100, 17, 70, 'Backup Commander', FALSE, TRUE),
(101, 18, 60, 'Backup Commander', FALSE, TRUE),
-- Recent mission crew assignments
(102, 14, 36, 'Mission Specialist', TRUE, FALSE),
(103, 20, 28, 'Flight Engineer', TRUE, FALSE),
(104, 21, 34, 'Commander', TRUE, FALSE),
(105, 21, 35, 'Pilot', TRUE, FALSE),
(106, 21, 14, 'Mission Specialist', TRUE, FALSE),
(107, 21, 19, 'Mission Specialist', TRUE, FALSE),
(108, 46, 34, 'Mission Specialist', TRUE, FALSE),
(109, 46, 35, 'Mission Specialist', TRUE, FALSE),
(110, 47, 22, 'Mission Specialist', TRUE, FALSE),
(111, 47, 19, 'Mission Specialist', TRUE, FALSE),
-- Space tourism missions
(112, 31, 38, 'Commander', TRUE, FALSE),
(113, 31, 39, 'Medical Officer', TRUE, FALSE),
(114, 31, 40, 'Pilot', TRUE, FALSE),
(115, 31, 41, 'Mission Specialist', TRUE, FALSE),
(116, 15, 42, 'Passenger', TRUE, FALSE),
(117, 16, 44, 'Passenger', TRUE, FALSE),
-- International cooperation missions
(118, 5, 83, 'Flight Engineer', TRUE, FALSE),
(119, 20, 20, 'Flight Engineer', TRUE, FALSE),
(120, 63, 83, 'Flight Engineer', TRUE, FALSE),
-- Multi-mission astronauts
(121, 3, 70, 'Commander', TRUE, FALSE),
(122, 19, 75, 'Mission Specialist', TRUE, FALSE),
(123, 51, 78, 'Mission Specialist', TRUE, FALSE),
(124, 52, 78, 'Mission Specialist', TRUE, FALSE),
(125, 53, 78, 'Mission Specialist', TRUE, FALSE),
(126, 54, 78, 'Mission Specialist', TRUE, FALSE),
-- Adding more crew for larger missions
(127, 45, 8, 'Expedition Commander', TRUE, FALSE),
(128, 45, 9, 'Flight Engineer', TRUE, FALSE),
(129, 45, 10, 'Flight Engineer', TRUE, FALSE),
(130, 45, 11, 'Flight Engineer', TRUE, FALSE),
(131, 45, 13, 'Flight Engineer', TRUE, FALSE),
(132, 45, 14, 'Flight Engineer', TRUE, FALSE),
(133, 45, 19, 'Flight Engineer', TRUE, FALSE),
(134, 45, 20, 'Flight Engineer', TRUE, FALSE),
(135, 45, 26, 'Flight Engineer', TRUE, FALSE),
(136, 45, 27, 'Flight Engineer', TRUE, FALSE),
(137, 45, 28, 'Flight Engineer', TRUE, FALSE),
(138, 45, 29, 'Flight Engineer', TRUE, FALSE),
(139, 45, 31, 'Flight Engineer', TRUE, FALSE),
(140, 45, 32, 'Flight Engineer', TRUE, FALSE),
(141, 45, 33, 'Flight Engineer', TRUE, FALSE),
(142, 45, 34, 'Flight Engineer', TRUE, FALSE),
(143, 45, 35, 'Flight Engineer', TRUE, FALSE),
(144, 45, 36, 'Flight Engineer', TRUE, FALSE),
-- Specialist roles for specific missions
(145, 25, 1, 'Principal Investigator', TRUE, FALSE),
(146, 26, 8, 'Observatory Operations', TRUE, FALSE),
(147, 27, 21, 'Rover Operations', TRUE, FALSE),
(148, 34, 55, 'Mission Commander', TRUE, FALSE),
(149, 35, 84, 'Landing Systems', TRUE, FALSE),
(150, 36, 16, 'Impact Coordinator', TRUE, FALSE),
(151, 37, 15, 'Trajectory Specialist', TRUE, FALSE),
(152, 38, 26, 'Sample Collection', TRUE, FALSE),
(153, 39, 19, 'Instruments Specialist', TRUE, FALSE),
(154, 40, 14, 'Orbital Dynamics', TRUE, FALSE),
(155, 41, 7, 'Navigation Specialist', TRUE, FALSE),
(156, 44, 9, 'Observatory Maintenance', TRUE, FALSE);

-- Exporting tables to Parquet files
COPY (FROM astronauts WHERE astronaut_id BETWEEN  1 AND  50 ORDER BY astronaut_id) TO 'astronauts.part1.parquet';
COPY (FROM astronauts WHERE astronaut_id BETWEEN 51 AND 100 ORDER BY astronaut_id) TO 'astronauts.part2.parquet';

COPY (FROM mission_crew WHERE mission_crew_id BETWEEN   1 AND  50 ORDER BY mission_crew_id) TO 'mission_crew.part1.parquet';
COPY (FROM mission_crew WHERE mission_crew_id BETWEEN  51 AND 100 ORDER BY mission_crew_id) TO 'mission_crew.part2.parquet';
COPY (FROM mission_crew WHERE mission_crew_id BETWEEN 101 AND 150 ORDER BY mission_crew_id) TO 'mission_crew.part3.parquet';
COPY (FROM mission_crew WHERE mission_crew_id BETWEEN 151 AND 200 ORDER BY mission_crew_id) TO 'mission_crew.part4.parquet';

COPY (FROM missions WHERE mission_id BETWEEN   1 AND  50 ORDER BY mission_id) TO 'missions.part1.parquet';
COPY (FROM missions WHERE mission_id BETWEEN  51 AND 100 ORDER BY mission_id) TO 'missions.part2.parquet';

COPY (FROM spacecraft WHERE spacecraft_id BETWEEN  1 AND 50 ORDER BY spacecraft_id) TO 'spacecraft.part1.parquet';
